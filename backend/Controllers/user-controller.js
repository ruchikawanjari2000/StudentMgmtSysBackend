const userModel = require('../Models/user');
const expressAsyncHandler = require('express-async-handler');






































































































































































































































































































































let userLogin = expressAsyncHandler( async (req,res) =>{

    let { email, password } = req.body;
    console.log(req.body)
    let newPass = md5(password);
    console.log(newPass)
  
    const userExists = await userModel.findOne({email:email,password:password})

    if (error) throw error;

    if(userExists) {
        const token = jwt.sign(
            { uid: results[0].id, email:results[0].email, fname: results[0].firstname  },
                process.env.TOKEN_KEY,
            {
                expiresIn: "2h",
            }
        );
        console.log('this is new token', token);
        results[0].token = token;
        res.send(results);
    }
   
})


    
module.exports = {userLogin};